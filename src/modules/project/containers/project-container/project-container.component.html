@if (project(); as project) {

	<w-portal>

		<button
			class="icon-only"
			[cdkMenuTriggerFor]="menu">
			<span class="material-symbols-outlined">menu_open</span>
		</button>

		<ng-template #menu>

			<div class="menu" cdkMenu>

				<button
					cdkMenuItem
					class="icon-only align-left"
					[routerLink]="['/projects', project.id, 'edit' ]">
					<span class="material-symbols-outlined">edit</span> Edit Project
				</button>

				<hr>

				<button
					cdkMenuItem
					class="icon-only align-left"
					[routerLink]="['/logs', project.id]">
					<span class="material-symbols-outlined">history</span> View Logs
				</button>

			</div>

		</ng-template>

	</w-portal>

	<!-- PROJECT -->
	<app-project
		[project]="project"
		[expanded]="projectExpanded()"
		(toggleInfo)="onToggleInfo()"/>

	<!-- SEARCH AND TAG CLOUD -->
	<app-project-search-and-tag-cloud-container/>

	<!-- TASKS (FIELDSET) -->
	<fieldset class="component">

		<legend>Tasks <small>({{ project.tasks.length }})</small></legend>
		<legend>
			<button
				class="icon-only small"
				(click)="onOpenNewTaskDialog()">
				<span class="material-symbols-outlined">add</span>
				Add Task
			</button>
		</legend>

		<small query_params>
			<span class="material-symbols-outlined small">filter_alt</span> Filters: {{ paramsText() }}
		</small>

		<div task_list>

			@for (task of project.tasks; track $index) {

				@let expanded = !!tasksExpanded()[task.id];
				<app-task
					[task]="task"
					[expanded]="expanded"
					(editTask)="onOpenEditTaskDialog($event)"
					(toggleTask)="onToggleTask($event)" />

			}

		</div>

	</fieldset>

} @else {

	<div class="card darker">

		<div class="empty">

			<span class="empty-message"><span class="material-symbols-outlined">check_circle</span>&nbsp;No project available</span>
			<button
				class="icon-only"
				[routerLink]="['/projects', 'new' ]">
				<span class="material-symbols-outlined">post_add</span> Add Project
			</button>

		</div>

	</div>

}
