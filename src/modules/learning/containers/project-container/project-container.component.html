@if (learning(); as learning) {

	<w-portal>

		<button
			class="link"
			[cdkMenuTriggerFor]="menu">
			<w-glyph name="menu_open" />
		</button>

		<ng-template #menu>

			<div class="menu" cdkMenu>

				<button
					cdkMenuItem
					class="link align-left"
					[routerLink]="['/learning', learning.id, 'edit' ]">
					<w-glyph name="edit" /> Edit Learning
				</button>

				<hr>

				<button
					cdkMenuItem
					class="link align-left"
					[routerLink]="['/logs', learning.id]">
					<w-glyph name="history" /> View Logs
				</button>

			</div>

		</ng-template>

	</w-portal>

	<!-- LEARNING -->
	<app-learning
		[learning]="learning"
		[expanded]="learningExpanded()"
		(toggleInfo)="onToggleInfo()"/>

	<!-- SEARCH AND TAG CLOUD -->
	<app-learning-search-and-tag-cloud-container/>

	<!-- TASKS (FIELDSET) -->
	<fieldset class="box d-flex-column gap-sm">

		<legend class="d-flex ai-bs gap-xs">Tasks <small>({{ learning.tasks.length }})</small></legend>
		<legend>
			<button
				class="link small"
				(click)="onOpenNewTaskDialog()">
				<w-glyph name="add" />
				Add Task
			</button>
		</legend>

		<!-- query_params -->
		<small class="d-flex ai-c">
			<span class="material-symbols-outlined small">filter_alt</span> Filters: {{ paramsText() }}
		</small>

		<!-- task_list -->
		<div class="d-flex-column gap-sm">

			@for (task of learning.tasks; track $index) {

				@let expanded = !!tasksExpanded()[task.id];
				<app-task
					[task]="task"
					[expanded]="expanded"
					(editTask)="onOpenEditTaskDialog($event)"
					(toggleTask)="onToggleTask($event)" />

			}

		</div>

	</fieldset>

} @else {

	<div class="card darker">

		<div class="empty">

			<span class="empty-message"><w-glyph name="check_circle" />&nbsp;No learning available</span>
			<button
				class="link"
				[routerLink]="['/learning', 'new' ]">
				<w-glyph name="post_add" /> Add Learning
			</button>

		</div>

	</div>

}
